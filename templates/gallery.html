<!DOCTYPE html>
<html lang="en">
<head>
  <script>
    (function(){
      var overlay = document.createElement('div');
      overlay.id = 'global-loading-overlay';
      overlay.style.position = 'fixed';
      overlay.style.top = '0';
      overlay.style.left = '0';
      overlay.style.width = '100vw';
      overlay.style.height = '100vh';
      overlay.style.background = '#fffbe6';
      overlay.style.zIndex = '99999';
      overlay.style.display = 'flex';
      overlay.style.alignItems = 'center';
      overlay.style.justifyContent = 'center';
      overlay.innerHTML = '<div id="lottie-global-box" style="width:220px;height:220px;"></div><div style="position:absolute;bottom:10vh;left:0;width:100vw;text-align:center;font-size:2em;font-weight:900;color:#d6af41;letter-spacing:2px;font-family:Montserrat,Arial,sans-serif;">Loading...</div>';
      document.body.appendChild(overlay);
      var script = document.createElement('script');
      script.src = 'https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.10.2/lottie.min.js';
      script.onload = function() {
        window.lottie && window.lottie.loadAnimation({
          container: document.getElementById('lottie-global-box'),
          renderer: 'svg',
          loop: true,
          autoplay: true,
          path: '/UI/Treasure box.json'
        });
      };
      document.head.appendChild(script);
    })();
  </script>
  <script>
    (function(){
      var overlay = document.createElement('div');
      overlay.id = 'global-loading-overlay';
      overlay.style.position = 'fixed';
      overlay.style.top = '0';
      overlay.style.left = '0';
      overlay.style.width = '100vw';
      overlay.style.height = '100vh';
      overlay.style.background = '#fffbe6';
      overlay.style.zIndex = '99999';
      overlay.style.display = 'flex';
      overlay.style.alignItems = 'center';
      overlay.style.justifyContent = 'center';
      overlay.innerHTML = '<div id="lottie-global-box" style="width:220px;height:220px;"></div><div style="position:absolute;bottom:10vh;left:0;width:100vw;text-align:center;font-size:2em;font-weight:900;color:#d6af41;letter-spacing:2px;font-family:Montserrat,Arial,sans-serif;">Loading...</div>';
      document.body.appendChild(overlay);
    })();
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#f6e4cb">
  <title>GALLERY - MemoQuest</title>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:900,700" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/gallery.css') }}">
    <script src="{{ url_for('static', filename='js/loading.js') }}"></script>
    <script src="{{ url_for('static', filename='js/gallery.js') }}"></script>
</head>
<body>
  <div class="bg-gallery" aria-hidden="true">
    <span>GALLERY</span>
    <span>GALLERY</span>
    <span>GALLERY</span>
    <span>GALLERY</span>
    <span>GALLERY</span>
    <span>GALLERY</span>
  </div>
  <div class="header-bar" style="justify-content: space-between;">
    <span class="memoquest-logo">MEMOQUEST</span>
    <form action="{{ url_for('upload_image') }}" method="post" enctype="multipart/form-data" style="margin-right: 18px;">
      <label for="upload-input" style="cursor:pointer; display:inline-block; background:#d6af41; border-radius:12px; padding:7px 16px; font-weight:700; color:#06263b; font-family:'Montserrat', Arial, sans-serif; font-size:1em; box-shadow:0 2px 8px #d6af4109; border:none;">
        <svg style="vertical-align:middle; margin-right:6px;" width="20" height="20" viewBox="0 0 20 20" fill="none"><rect x="3" y="3" width="14" height="14" rx="3" stroke="#06263b" stroke-width="2"/><path d="M10 6V14" stroke="#06263b" stroke-width="2" stroke-linecap="round"/><path d="M6 10H14" stroke="#06263b" stroke-width="2" stroke-linecap="round"/></svg>
        Upload
        <input id="upload-input" type="file" name="image" accept="image/*,video/*" style="display:none;" onchange="this.form.submit()">
      </label>
    </form>
  </div>
  <div class="main-section">
    <div class="yellow-box">
      <span>TEAM GALLERY</span>
    </div>
    {% if images and images|length > 0 %}
    <div class="gallery-grid">
      {% for url in images %}
        <div style="position:relative; display:inline-block;">
          {% if url.endswith('.mp4') or url.endswith('.webm') or url.endswith('.ogg') or url.endswith('.mov') %}
            <video width="100" height="100" controls style="border-radius:8px; background:#fff; object-fit:cover; cursor:pointer;" onclick="openMediaModal('{{ url }}', 'video')">
              <source src="{{ url }}">
              Your browser does not support the video tag.
            </video>
          {% else %}
            <img src="{{ url }}" alt="Team Media" style="cursor:pointer;" onclick="openMediaModal('{{ url }}', 'image')">
          {% endif %}
          <form method="POST" action="{{ url_for('delete_media') }}" style="position:absolute; top:2px; right:2px; z-index:10;">
            <input type="hidden" name="media_url" value="{{ url }}">
            <button type="submit" style="background:rgba(220,40,40,0.85); border:none; color:#fff; border-radius:50%; width:24px; height:24px; font-size:1.1em; font-weight:900; cursor:pointer; line-height:1; padding:0;">&times;</button>
          </form>
        </div>
      {% endfor %}
    </div>

    <!-- Fullscreen Modal -->
    <div id="mediaModal" style="display:none; position:fixed; z-index:9999; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.92); align-items:center; justify-content:center;">
      <span onclick="closeMediaModal()" style="position:absolute; top:24px; right:32px; color:#fff; font-size:2.5em; font-weight:900; cursor:pointer; z-index:10001;">&times;</span>
      <div id="modalContent" style="max-width:96vw; max-height:90vh; display:flex; align-items:center; justify-content:center;"></div>
    </div>
    {% else %}
    <p style="text-align:center; color:#888; margin-top:24px;">No photos uploaded yet.</p>
    {% endif %}
    <a href="{{ url_for('profile') }}" class="back-link">&larr; Back to Profile</a>
  </div>
</body>
</html>
